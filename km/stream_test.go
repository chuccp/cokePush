package km

import (
	"github.com/chuccp/cokePush/message"
	"github.com/chuccp/cokePush/util"
	"testing"
	"time"
)

/**
测试message 转 chunk
*/
func TestStream_WriteMessage(t *testing.T) {

	fs, err := util.NewFileStream("D:\\attach\\bb.bin")
	time1 := time.Now()
	var i = 0
	if err == nil {
		for ; i < 1; i++ {
			fs.Seek(0)
			k := NewKm00001(fs)
			msg, err := k.ReadMessage()
			if err == nil {
				msg.GetTimestamp()
			} else {
				t.Log(err)
			}
		}
	}

	time2 := time.Now()

	t.Log(time2.Sub(time1))

}
func TestStream_ReadMessage(t *testing.T) {

	bm := message.CreateBasicMessage("555522222225555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333335555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232151232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232152312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123255552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321513123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215", "555522222225555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333335555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232151232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232152312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123255552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321513123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215", "555522222225555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333335555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232151232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232152312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123255552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321513123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215555522222222312312312312312312321321321321333333333333333333333333333333333333312321312333333333331231231232155555222222223123123123123123123213213213213333333333333333333333333333333333333123213123333333333312312312321555552222222231231231231231231232132132132133333333333333333333333333333333333331232131233333333333123123123215")

	fs, err := util.NewFileStream("D:\\attach\\bb.bin")
	time1 := time.Now()
	if err == nil {
		k := NewKm00001(fs)
		k.WriteMessage(bm)
	}
	time2 := time.Now()

	t.Log(time2.Sub(time1))
}
